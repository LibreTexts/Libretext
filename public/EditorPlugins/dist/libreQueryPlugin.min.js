console.log("CKEditor LibreQuery Plugin"),LibreEditor.libreQuery=e=>{Array.isArray(e.toolbar[12])&&e.toolbar[12].push("LibreQueryOptions"),CKEDITOR.plugins.add("LibreQuery",{require:["richcombo"],init(e){const t="Query",r=[{template:"QueryH5P",value:"query-h5p",text:"H5P"},{template:"QueryIMath",value:"query-imath",text:"IMath"},{template:"QueryWebWork",value:"query-webwork",text:"WeBWorK"}];for(let t=0,o=r.length;t<o;t+=1)e.addCommand(r[t].value,{async exec(e){const o="Sorry, we're having trouble loading the template. Please use Elements > Templates to insert.";try{const a=new XMLHttpRequest;a.onerror=e=>{console.error(e),alert(o)},a.onload=()=>{console.log(a.responseText);const t=JSON.parse(a.responseText);"string"==typeof t.template&&e.insertHtml(t.template.trim())},a.open("PUT","https://api.libretexts.org/endpoint/template"),a.setRequestHeader("Content-Type","application/json;"),a.send(JSON.stringify({path:`Template:${r[t].template}`,subdomain:LibreTexts.extractSubdomain()}))}catch(e){alert(o),console.error(e)}}});e.ui.addRichCombo("LibreQueryOptions",{label:t,title:t,voiceLabel:t,toolbar:"insert",multiSelect:!1,className:"cke_librequery",panel:{css:[e.config.contentsCss,CKEDITOR.skin.getPath("editor")],voiceLabel:t,attributes:{"aria-label":t}},init(){this.startGroup(t);for(let e=0,t=r.length;e<t;e+=1)this.add(r[e].value,`<span>${r[e].text}</span>`,r[e].text)},onClick(t){e.execCommand(t)}})}}),CKEDITOR.config.extraPlugins+=(""===CKEDITOR.config.extraPlugins?"":",")+"LibreQuery"};